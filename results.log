===================part1 : Sessionize the web log by IP ======================
+-------------+-------------------+--------------------+--------------------+------------+----------+--------------------+
|    timestamp|           clientIp|             request|          user_agent|duration(ms)|newSession|           sessionId|
+-------------+-------------------+--------------------+--------------------+------------+----------+--------------------+
|1437581655130|1.187.167.214:65257|GET http://www.pa...|UCWEB/2.0 (Symbia...|           0|         0|1.187.167.214:652...|
|1437581907178| 1.187.170.77:64760|GET https://paytm...|Mozilla/5.0 (Linu...|           0|         0|1.187.170.77:6476...|
|1437606953368|1.187.179.217:34549|GET https://paytm...|Mozilla/5.0 (Linu...|           0|         0|1.187.179.217:345...|
|1437607058045|1.187.179.217:34549|GET https://paytm...|Mozilla/5.0 (Linu...|      104677|         0|1.187.179.217:345...|
|1437607323046|1.187.179.217:34549|GET https://paytm...|Mozilla/5.0 (Linu...|      265001|         0|1.187.179.217:345...|
|1437608096801|1.187.185.201:46980|POST https://payt...|Mozilla/5.0 (Wind...|           0|         0|1.187.185.201:469...|
|1437588382195| 1.187.202.35:38668|GET https://paytm...|Mozilla/5.0 (Wind...|           0|         0|1.187.202.35:3866...|
|1437588383601| 1.187.202.35:38668|GET https://paytm...|Mozilla/5.0 (Wind...|        1406|         0|1.187.202.35:3866...|
|1437588387513| 1.187.202.35:38668|GET https://paytm...|Mozilla/5.0 (Wind...|        3912|         0|1.187.202.35:3866...|
|1437588561954| 1.187.202.35:38668|GET https://paytm...|Mozilla/5.0 (Wind...|      174441|         0|1.187.202.35:3866...|
|1437588959574| 1.187.202.35:38668|GET https://paytm...|Mozilla/5.0 (Wind...|      397620|         0|1.187.202.35:3866...|
|1437607239046|  1.187.214.14:6921|GET https://paytm...|Mozilla/5.0 (Linu...|           0|         0|1.187.214.14:6921...|
|1437607582270|  1.187.214.14:6921|GET https://paytm...|Mozilla/5.0 (Linu...|      343224|         0|1.187.214.14:6921...|
|1437607687932|  1.187.214.14:6921|GET https://paytm...|Mozilla/5.0 (Linu...|      105662|         0|1.187.214.14:6921...|
|1437607705604|  1.187.214.14:6921|GET https://paytm...|Mozilla/5.0 (Linu...|       17672|         0|1.187.214.14:6921...|
|1437588345559|1.187.224.105:12587|GET https://paytm...|Mozilla/5.0 (Wind...|           0|         0|1.187.224.105:125...|
|1437613268150| 1.187.224.54:28093|GET https://paytm...|Mozilla/5.0 (Wind...|           0|         0|1.187.224.54:2809...|
|1437613638575| 1.187.224.54:28093|GET https://paytm...|Mozilla/5.0 (Wind...|      370425|         0|1.187.224.54:2809...|
|1437613847309| 1.187.224.54:28093|GET https://paytm...|Mozilla/5.0 (Wind...|      208734|         0|1.187.224.54:2809...|
|1437608696672|  1.187.51.226:7451|GET https://paytm...|Mozilla/5.0 (Wind...|           0|         0|1.187.51.226:7451...|
+-------------+-------------------+--------------------+--------------------+------------+----------+--------------------+
only showing top 20 rows


===================part2 : Determine the average session time ======================
+-----------------+
|avg(duration(ms))|
+-----------------+
|664016.6889063445|
+-----------------+


===================part3 : Determine unique URL visits per session ======================
+--------------------+--------------+
|           sessionId|count(request)|
+--------------------+--------------+
|122.170.106.174:5...|             5|
|37.228.105.143:48...|             8|
|1.39.12.223:62334...|             3|
|116.50.78.194:648...|            14|
|117.211.25.210:21...|             2|
|123.63.90.41:6384...|             1|
|54.169.1.152:3603...|             1|
|61.1.129.207:6169...|             5|
|101.56.43.253:516...|            12|
|115.250.23.174:23...|             6|
|119.81.61.166:481...|             2|
|180.87.252.88:323...|             3|
|59.145.220.190:55...|             2|
|182.56.78.2:10577...|             2|
|112.79.38.100:440...|             9|
|182.66.45.39:4419...|             1|
|54.169.1.152:4748...|             1|
|61.3.98.139:20236...|            12|
|210.18.28.174:114...|             1|
|219.91.201.236:33...|             9|
+--------------------+--------------+
only showing top 20 rows


===================part4 : Find the most engaged users ======================
+-------------------+-----------------+
|           clientIp|sum(duration(ms))|
+-------------------+-----------------+
|119.81.61.166:36205|         67413284|
| 52.74.219.71:55433|         67348576|
|106.186.23.95:42887|         67347959|
|119.81.61.166:36946|         67295731|
|119.81.61.166:34305|         67279915|
| 52.74.219.71:55670|         67277045|
|119.81.61.166:32843|         67275094|
| 52.74.219.71:53717|         67236027|
| 52.74.219.71:53712|         67225359|
|106.186.23.95:42552|         67194262|
|106.186.23.95:43478|         67191138|
| 52.74.219.71:34288|         67185012|
|106.186.23.95:42091|         67182715|
|119.81.61.166:45705|         67175035|
|119.81.61.166:52301|         67169214|
|106.186.23.95:40411|         67167705|
| 52.74.219.71:49603|         67144399|
|106.186.23.95:39198|         67144134|
|106.186.23.95:43467|         67137690|
|119.81.61.166:42134|         67131735|
+-------------------+-----------------+
only showing top 20 rows